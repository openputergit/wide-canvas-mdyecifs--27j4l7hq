<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerPoint Viewer</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        .viewer-container {
            touch-action: manipulation;
        }
        .slide-content {
            transition: transform 0.3s ease;
        }
        .controls {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }
        .loading-spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- URL Input Section -->
        <div class="mb-8">
            <div class="max-w-xl mx-auto">
                <label for="pptUrl" class="block text-sm font-medium text-gray-700 mb-2">Enter PowerPoint URL</label>
                <div class="flex gap-2">
                    <input type="url" id="pptUrl" 
                           class="flex-1 rounded-lg border border-gray-300 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                           placeholder="https://example.com/presentation.pptx">
                    <button onclick="loadPresentation()" 
                            class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                        Load
                    </button>
                </div>
            </div>
        </div>

        <!-- Presentation Viewer -->
        <div class="viewer-container relative bg-white rounded-xl shadow-lg max-w-4xl mx-auto overflow-hidden" style="min-height: 60vh;">
            <!-- Loading State -->
            <div id="loading" class="hidden absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50">
                <div class="loading-spinner text-blue-500 text-4xl">
                    <i class="bi bi-arrow-repeat"></i>
                </div>
            </div>

            <!-- Content Container -->
            <div id="slideContainer" class="relative w-full h-full">
                <div id="slideContent" class="slide-content w-full h-full flex items-center justify-center">
                    <p class="text-gray-500">Enter a PowerPoint URL to begin</p>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls fixed bottom-0 left-0 right-0 p-4 flex items-center justify-center gap-4">
                <button onclick="previousSlide()" class="text-white hover:text-blue-200 transition-colors">
                    <i class="bi bi-chevron-left text-2xl"></i>
                </button>
                <div class="flex items-center gap-2">
                    <button onclick="zoomOut()" class="text-white hover:text-blue-200 transition-colors">
                        <i class="bi bi-zoom-out text-xl"></i>
                    </button>
                    <button onclick="zoomIn()" class="text-white hover:text-blue-200 transition-colors">
                        <i class="bi bi-zoom-in text-xl"></i>
                    </button>
                </div>
                <button onclick="nextSlide()" class="text-white hover:text-blue-200 transition-colors">
                    <i class="bi bi-chevron-right text-2xl"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentScale = 1;
        let currentSlide = 0;
        let totalSlides = 0;
        let presentation = null;

        // Initialize touch events
        const slideContent = document.getElementById('slideContent');
        let touchStartX = 0;
        let touchEndX = 0;

        slideContent.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        });

        slideContent.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchEndX - touchStartX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    previousSlide();
                } else {
                    nextSlide();
                }
            }
        }

        async function loadPresentation() {
            const url = document.getElementById('pptUrl').value;
            if (!url || !url.endsWith('.pptx')) {
                alert('Please enter a valid PowerPoint URL');
                return;
            }

            document.getElementById('loading').classList.remove('hidden');

            try {
                // In a real implementation, this would connect to a backend service
                // that converts PPTX to HTML5/WebView compatible format
                await simulateLoading();
                
                // Simulate successful loading
                totalSlides = 10; // This would come from the actual presentation
                currentSlide = 0;
                updateSlide();
            } catch (error) {
                alert('Error loading presentation');
            } finally {
                document.getElementById('loading').classList.add('hidden');
            }
        }

        function simulateLoading() {
            return new Promise(resolve => setTimeout(resolve, 1500));
        }

        function updateSlide() {
            slideContent.innerHTML = `
                <div class="text-center">
                    <h2 class="text-2xl font-bold mb-4">Slide ${currentSlide + 1} of ${totalSlides}</h2>
                    <div class="bg-gray-200 w-96 h-64 rounded-lg flex items-center justify-center">
                        <p>Slide Content Would Appear Here</p>
                    </div>
                </div>
            `;
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                currentSlide++;
                updateSlide();
            }
        }

        function previousSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                updateSlide();
            }
        }

        function zoomIn() {
            if (currentScale < 3) {
                currentScale += 0.2;
                applyZoom();
            }
        }

        function zoomOut() {
            if (currentScale > 0.5) {
                currentScale -= 0.2;
                applyZoom();
            }
        }

        function applyZoom() {
            slideContent.style.transform = `scale(${currentScale})`;
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowRight':
                    nextSlide();
                    break;
                case 'ArrowLeft':
                    previousSlide();
                    break;
                case '+':
                    zoomIn();
                    break;
                case '-':
                    zoomOut();
                    break;
            }
        });
    </script>
<script>document.body.addEventListener('wheel', e => { if (!e.ctrlKey) return; e.preventDefault(); return }, { passive: false })</script>
	</body>
</html>